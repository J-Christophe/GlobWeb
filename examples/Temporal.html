<html>

<head>
<title>Temporal example</title>
<meta http-equiv="content-type" content="text/html; charset=ISO-8859-1">
<link rel="stylesheet" href="GlobWeb.css">
<script  src="require.min.js"></script>
<script type="text/javascript" src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
<script type="text/javascript">
	
require(['../src/GlobWeb', '../src/TemporalWMSLayer'], function (GlobWeb, TemporalWMSLayer) 
{	
	var cvs = document.getElementById("GlobWebCanvas");
	cvs.width = window.innerWidth;
	cvs.height = window.innerHeight;
	
	// Create the globe
	var globe = new GlobWeb.Globe( {
		canvas: cvs, 
		lighting: false,
		tileErrorTreshold: 3, 
		continuousRendering: true,
		shadersPath: "http://demonstrator.telespazio.com/globweb/shaders/"
	} );

	// Add mouse navigation
	var navigation = new GlobWeb.Navigation(globe, { inertia: true, zoomFactor: 0 });
	
	// Add stats
	var stats = new GlobWeb.Stats( globe, {element: 'fps', verbose: false} );

	// var blueMarbleLayer = new GlobWeb.WMSLayer({
	// 	baseUrl: "http://demonstrator.telespazio.com/wmspub",
	// 	layers: "BlueMarble",
	// 	opacity: 0.5
	// });
	// globe.addLayer( blueMarbleLayer );
	// var otherLayer = new GlobWeb.WMSLayer({
	// 	"baseUrl": "http://localhost/osm",
	// 	"layers": "imposm-fr",
	// 	"opacity": 0.3
	// });
	// globe.addLayer( otherLayer );

	var temporalLayer = new TemporalWMSLayer({
		baseUrls: [
		{
			baseUrl: "http://demonstrator.telespazio.com/wmspub",
			layers: "BlueMarble"
		},
		{
			baseUrl: "http://localhost/wmspub",
			layers: "precip.mon.total.2.5x2.5.v6_B1"
		},
		{
			baseUrl: "http://localhost/wmspub",
			layers: "precip.mon.total.2.5x2.5.v6_B2"
		},
		{
			baseUrl: "http://localhost/wmspub",
			layers: "precip.mon.total.2.5x2.5.v6_B3"
		},
		{
			baseUrl: "http://localhost/wmspub",
			layers: "precip.mon.total.2.5x2.5.v6_B4"
		},
		{
			baseUrl: "http://localhost/wmspub",
			layers: "precip.mon.total.2.5x2.5.v6_B5"
		},
		{
			baseUrl: "http://demonstrator.telespazio.com/wmspub",
			layers: "NightWorld"
		},
		{
			baseUrl: "http://localhost/osm",
			layers: "imposm-fr"
		},
		{
			baseUrl: "http://demonstrator.telespazio.com/wmspub",
			layers: "Tropiques"
		}/*,
		{
			baseUrl: "http://localhost/demis?WMS=WorldMap",
			layers: "Countries"
		}*/]
	});
	globe.addLayer( temporalLayer );
	
	temporalLayer.subscribe("animation:paused", function() {
		$("#loading").show();
	});
	temporalLayer.subscribe("animation:unpaused", function() {
		$("#loading").hide();
	});

	$('#stop').click(function(){
		temporalLayer.stop();
	});

	$('#time').on('input', function(){
		console.log($(this).val());
		temporalLayer.time = parseFloat($(this).val());
	});

	$('#next').click(function(){
		temporalLayer.next();
	});

	$('#start').click(function(){
		temporalLayer.start();
	});

	temporalLayer.subscribe("time:changed", function(){
		$('#time').val(0);
	});
});


</script>

</head>


<body style="margin: 0; padding: 0;">

	<div style="background-color: white; padding: 10px; position: absolute; margin: 20px; width: 20%; border-radius: 10px;">
		<input id="time" type="range" value="0" max="1" min="0" step="0.1">
		<span id="loading">Loading..</span>
		<br/>
		<button id="start">Start</button>
		<button id="stop">Stop</button>
		<button id="next">Next</button>
	</div>

    <canvas id="GlobWebCanvas" style="border: none; margin: 0; padding: 0;" width="800" height="600"></canvas> 
 	<div id="fps"></div>

</body>

</html>

